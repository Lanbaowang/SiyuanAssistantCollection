## 功能

这是一个实用功能和AI助手几何插件（SiyuanAssistantCollection），不是Stand Alone Complex的意思。

主要是一些实用小工功能，还有一些AI助手的界面对接。

## 组成

### 向量数据生成、存储和查询

#### 数据结构

由于部分属性其实并不适合放到思源的数据库里面(因为所有的自定义属性都会被渲染到DOM中),所以我们重新创建了一个新的键值对存储.

对于思源中所有有ID的对象,都可以通过这个KV存储来扩展它们的属性内容.

#### 数据同步

数据同步使用websocket,当任意一个前端网页发生数据更新时,它会做这几件事:

1.通过websocket广播提醒各个端更新本地数据库实例.

2.将新的数据库拷贝落盘存储

#### 性能优化

为了达到比较好的性能,所有的数据将会按照ID对8取模的值,存储在一个json文件中.

当对应的ID被查询时,将会以K近邻检索查询最近的1000个ID并将它们也载入到内存,检索向量来自embedding,


#### 服务端与客户端

这个数据库没有服务端，使用的是思源的文件接口。

## 感谢

向量嵌入部分使用了transformers.js库

向量嵌入部分使用了shibing624的text2vec-base-chinese模型

分词依赖jieba与pinyin