/* esm.sh - esbuild bundle(cookies@0.8.0) es2022 production */
import * as __0$ from "./stream-http.js";
import * as __1$ from "./crypto-browserify.js";
import * as __2$ from "./crypto-browserify.js";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"http":return e(__0$);case"crypto":return e(__1$);default:throw new Error("module \""+n+"\" not found");}};
var R=Object.create;var x=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var k=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),G=(e,t)=>{for(var r in t)x(e,r,{get:t[r],enumerable:!0})},v=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of M(t))!B.call(e,i)&&i!==r&&x(e,i,{get:()=>t[i],enumerable:!(n=$(t,i))||n.enumerable});return e},h=(e,t,r)=>(v(e,t,"default"),r&&v(r,t,"default")),q=(e,t,r)=>(r=e!=null?R(U(e)):{},v(t||!e||!e.__esModule?x(r,"default",{value:e,enumerable:!0}):r,e));var b=g((ie,_)=>{"use strict";_.exports=I;function I(e){if(!e)throw new TypeError("argument namespace is required");function t(r){}return t._file=void 0,t._ignored=!0,t._namespace=e,t._traced=!1,t._warned=Object.create(null),t.function=L,t.property=N,t}function L(e,t){if(typeof e!="function")throw new TypeError("argument fn must be a function");return e}function N(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(e,t);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable")}});var T=g((ne,C)=>{"use strict";var y=k("crypto");function X(e,t){if(e.length!==t.length)return!1;if(y.timingSafeEqual)return y.timingSafeEqual(e,t);for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function z(e,t){var r=String(e),n=String(t),i=y.pseudoRandomBytes(32),s=y.createHmac("sha256",i).update(r).digest(),o=y.createHmac("sha256",i).update(n).digest();return X(s,o)&&e===t}C.exports=z});var H=g((se,A)=>{"use strict";var F=T(),J=k("crypto");function p(e,t,r){if(t||(t="sha1"),r||(r="base64"),!(this instanceof p))return new p(e,t,r);if(!e||!(0 in e))throw new Error("Keys must be provided.");function n(i,s){return J.createHmac(t,s).update(i).digest(r).replace(/\/|\+|=/g,function(o){return{"/":"_","+":"-","=":""}[o]})}this.sign=function(i){return n(i,e[0])},this.verify=function(i,s){return this.index(i,s)>-1},this.index=function(i,s){for(var o=0,u=e.length;o<u;o++)if(F(s,n(i,e[o])))return o;return-1}}p.sign=p.verify=p.index=function(){throw new Error("Usage: require('keygrip')(<array-of-keys>)")};A.exports=p});var S=g((oe,j)=>{"use strict";var l=b()("cookies"),O=H(),Q=k("http"),E={},m=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,V=/^(?:lax|none|strict)$/i;function f(e,t,r){if(!(this instanceof f))return new f(e,t,r);this.secure=void 0,this.request=e,this.response=t,r&&(Array.isArray(r)?(l('"keys" argument; provide using options {"keys": [...]}'),this.keys=new O(r)):r.constructor&&r.constructor.name==="Keygrip"?(l('"keys" argument; provide using options {"keys": keygrip}'),this.keys=r):(this.keys=Array.isArray(r.keys)?new O(r.keys):r.keys,this.secure=r.secure))}f.prototype.get=function(e,t){var r=e+".sig",n,i,s,o,u,d,w=t&&t.signed!==void 0?t.signed:!!this.keys;if(n=this.request.headers.cookie,!!n&&(i=n.match(W(e)),!!i)){if(s=i[1],!t||!w)return s;if(o=this.get(r),!!o){if(u=e+"="+s,!this.keys)throw new Error(".keys required for signed cookies");if(d=this.keys.index(u,o),d<0)this.set(r,null,{path:"/",signed:!1});else return d&&this.set(r,this.keys.sign(u),{signed:!1}),s}}};f.prototype.set=function(e,t,r){var n=this.response,i=this.request,s=n.getHeader("Set-Cookie")||[],o=this.secure!==void 0?!!this.secure:i.protocol==="https"||i.connection.encrypted,u=new a(e,t,r),d=r&&r.signed!==void 0?r.signed:!!this.keys;if(typeof s=="string"&&(s=[s]),!o&&r&&r.secure)throw new Error("Cannot send secure cookie over unencrypted connection");if(u.secure=r&&r.secure!==void 0?r.secure:o,r&&"secureProxy"in r&&(l('"secureProxy" option; use "secure" option, provide "secure" to constructor if needed'),u.secure=r.secureProxy),P(s,u),r&&d){if(!this.keys)throw new Error(".keys required for signed cookies");u.value=this.keys.sign(u.toString()),u.name+=".sig",P(s,u)}var w=n.set?Q.OutgoingMessage.prototype.setHeader:n.setHeader;return w.call(n,"Set-Cookie",s),this};function a(e,t,r){if(!m.test(e))throw new TypeError("argument name is invalid");if(t&&!m.test(t))throw new TypeError("argument value is invalid");this.name=e,this.value=t||"";for(var e in r)this[e]=r[e];if(this.value||(this.expires=new Date(0),this.maxAge=null),this.path&&!m.test(this.path))throw new TypeError("option path is invalid");if(this.domain&&!m.test(this.domain))throw new TypeError("option domain is invalid");if(this.sameSite&&this.sameSite!==!0&&!V.test(this.sameSite))throw new TypeError("option sameSite is invalid")}a.prototype.path="/";a.prototype.expires=void 0;a.prototype.domain=void 0;a.prototype.httpOnly=!0;a.prototype.sameSite=!1;a.prototype.secure=!1;a.prototype.overwrite=!1;a.prototype.toString=function(){return this.name+"="+this.value};a.prototype.toHeader=function(){var e=this.toString();return this.maxAge&&(this.expires=new Date(Date.now()+this.maxAge)),this.path&&(e+="; path="+this.path),this.expires&&(e+="; expires="+this.expires.toUTCString()),this.domain&&(e+="; domain="+this.domain),this.sameSite&&(e+="; samesite="+(this.sameSite===!0?"strict":this.sameSite.toLowerCase())),this.secure&&(e+="; secure"),this.httpOnly&&(e+="; httponly"),e};Object.defineProperty(a.prototype,"maxage",{configurable:!0,enumerable:!0,get:function(){return this.maxAge},set:function(e){return this.maxAge=e}});l.property(a.prototype,"maxage",'"maxage"; use "maxAge" instead');function W(e){return E[e]?E[e]:E[e]=new RegExp("(?:^|;) *"+e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"=([^;]*)")}function P(e,t){if(t.overwrite)for(var r=e.length-1;r>=0;r--)e[r].indexOf(t.name+"=")===0&&e.splice(r,1);e.push(t.toHeader())}f.connect=f.express=function(e){return function(t,r,n){t.cookies=r.cookies=new f(t,r,{keys:e}),n()}};f.Cookie=a;j.exports=f});var c={};G(c,{Cookie:()=>Z,connect:()=>Y,default:()=>re});var K=q(S());h(c,q(S()));var{connect:Y,Cookie:Z}=K,{default:D,...ee}=K,re=D!==void 0?D:ee;export{Z as Cookie,Y as connect,re as default};
/*! Bundled license information:

depd/lib/browser/index.js:
  (*!
   * depd
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

keygrip/index.js:
  (*!
   * keygrip
   * Copyright(c) 2011-2014 Jed Schmidt
   * MIT Licensed
   *)

cookies/index.js:
  (*!
   * cookies
   * Copyright(c) 2014 Jed Schmidt, http://jed.is/
   * Copyright(c) 2015-2016 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/
//# sourceMappingURL=cookies.bundle.mjs.map